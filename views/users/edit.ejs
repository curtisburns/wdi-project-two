<script type="text/javascript" src="https://static.filestackapi.com/v3/filestack.js"></script>


<form class="edit" action="/user/<%= user.id %>" method="POST">
  <div class="field">
    <a class="button" id="pickImage"> Pick an image</a>
    <label class="label" for="profilePicture" >Profile Picture (URL)</label>
    <div class="control">
      <input class="input" type="text" name="profilePicture" id="profilePicture"  value="<%= user.profilePicture %>">
    </div>
  </div>
  <div class="field">
    <label class="label" for="username">Username</label>
    <div class="control">
      <input class="input" type="text" name="username" value="<%= user.username %>">
    </div>
  </div>
  <div class="field">
    <label class="label" for="email">Email</label>
    <div class="control">
      <input class="input" type="email" name="email" value="<%= user.email %>">
    </div>
  </div>


  <button class="button">Save</button>
  <input type="hidden" name="_method" value="PUT">

</form>

<script>
const client = filestack.init('AexgdNExkS7KW6EtgRtLPz');
const btn = document.getElementById('pickImage')


btn.addEventListener('click', function () {
  client.pick({
    accept: 'image/jpeg',
    transformations: {
      crop: {
        aspectRatio: 1,
        force: true
      }
    }
  })
  .then(function(data) {
    document.getElementById('profilePicture').value = data.filesUploaded[0].url;
  })
});

</script>
